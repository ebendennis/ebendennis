


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>
	Maps
</title><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.js"></script>
    <link href="//api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.css" rel="stylesheet" />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
            .leaflet-control-locate {
            border: 1px solid rgba(0,0,0,0.4);
        }

        .leaflet-control-locate a {
            background-color: #fff;
            background-position: -3px, -2px;
        }

        .leaflet-control-locate.active a {
            background-position: -33px -2px;
        }
  </style>
    
    <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v0.0.4/Leaflet.fullscreen.min.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v0.0.4/leaflet.fullscreen.css' rel='stylesheet' />
    <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.42.0/L.Control.Locate.min.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.42.0/L.Control.Locate.mapbox.css' rel='stylesheet' />
    <!--[if lt IE 9]>
      <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.42.0/L.Control.Locate.ie.css' rel='stylesheet' />
    <![endif]-->
    <link href='http://www.lfchistory.net/css/Maps.css?v=1' rel='stylesheet' />
</head>
<body>
    <form name="aspnetForm" method="post" action="./PremierLeague.aspx" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTY1NDU2MTA1MmRk2RpB6timIIHCvyaPPwrX/Ou59c4ydGWdsBNSH9212pQ=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="6B60E204" />
</div>
    <div>
        

<div id='map'></div>

<div id='footer'>
    <div id="text">
        Liverpool Players in the Premier League Era - Where Are They From?
    </div>
    <div id="oyb"> With thanks to:  
        <a href="http://ohyoubeauty.blogspot.com">oh you beauty</a> and <a href="http://ebendennis.github.io/">Eben Dennis</a>
    </div>
    <div id="chartophile">
        All data from <a href="http://www.lfchistory.net">LFChistory.net</a>
    </div>
</div>

<script>
    $(document).ready(function () {

    L.mapbox.accessToken = 'pk.eyJ1IjoibGZjaGlzdG9yeSIsImEiOiJuMmVNYVZNIn0.GtZ8mjC_Boi-x3I6f7uIqg';
    var map = L.mapbox.map('map', 'lfchistory.m32c4a17').setView([0, 0], 2);
    var geoJson = [];

    var featureLayer = L.mapbox.featureLayer(geoJson).addTo(map);

    $.getJSON("http://www.lfchistory.net/api/Players/PremierLeague?callback=?", function (result) {
        $.each(result, function () {
            
            if (this.GeoLong.toString().length > 2) {
                geoJson.push({
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [this.GeoLong, this.GeoLat]
                    },
                    "properties": {
                        "id": this.ID,
                        "first": this.PlayerNameFirst,
                        "last": this.PlayerNameLast,
                        "image": "http://www.lfchistory.net/images/profiles/" + this.Image,
                        "city": this.City,
                        "country": this.Country,
                        "debut": this.Debut,
                        "seasonstot": "2",
                        "apps": "37",
                        "goals": "2",
                        "icon": {
                            "iconUrl": "http://www.lfchistory.net/images/lfc_red.png",
                            "iconSize": [80, 40],
                            "iconAnchor": [10, 40],
                            "popupAnchor": [0, -32],
                            "className": "dot"
                        }
                    }
                });
            }
        });
    });
        featureLayer.on('layeradd', function (e) {
            var marker = e.layer,
                feature = marker.feature;

            var popupContent = '<div id="popup">' +
                '<div id="first">' + feature.properties.first + '</div>' +
                '<div id="last">' + feature.properties.last + '</div>' +
                '<div id="image">' + '<img src="' + feature.properties.image + '">' + '</div>' +
                '<div id="location">'+feature.properties.city +', '+ '<b>'+feature.properties.country+'</b>' + '</div>' +
                '<div class="data">'+'<b>'+'Debut date'+'</b>' + ': ' + feature.properties.debut + '</div>' +
                '<div class="data">' + '<b><a href="http://www.lfchistory.net/Players/Player/Profile/' + feature.properties.id + '">Click here to view his profile</a></b></div>' + '</div>';

            marker.setIcon(L.icon(feature.properties.icon));

            marker.bindPopup(popupContent,{
               closeButton: false,
               autoPanPadding:[25,10],
               maxWidth: 320,
               minWidth: 200
            });
        });

        featureLayer.setGeoJSON(geoJson);

        L.control.fullscreen().addTo(map);
        L.control.locate().addTo(map);

    });
    console.log(geoJson);
    });
</script>    

    </div>
    </form>
</body>
</html>
